/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 13 00:05
*/
KISSY.add("component/control/process",function(c,k,h){function q(g){g.fire("beforeSyncUI");g.syncUI();e(g,"pluginSyncUI");g.fire("afterSyncUI")}function e(g,c){var e,a=g.get("plugins");if(e=a.length)for(var b=0;b<e;b++)a[b][c].apply(this,arguments||[])}var r=h.Defer,h=k.prototype.__getHook__,c=c.noop,o=k.extend({bindInternal:c,syncInternal:c,initializer:function(){this._renderedDefer=new r},createDom:c,renderUI:c,bindUI:c,syncUI:c,onRendered:function(c){return this._renderedDefer.promise.then(c)},
create:function(){this.get("created")||(this.fire("beforeCreateDom"),this.createInternal(),e(this,"pluginCreateDom"),this.fire("afterCreateDom"),this.setInternal("created",!0));return this},createInternal:function(){this.createDom()},render:function(){this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),e(this,"pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),o.superclass.bindInternal.call(this),this.bindUI(),e(this,"pluginBindUI"),this.fire("afterBindUI"),
o.superclass.syncInternal.call(this),q(this),this.setInternal("rendered",!0));return this},sync:function(){q(this)},plug:function(){var c;c=this.get("plugins");o.superclass.plug.apply(this,arguments);c=c[c.length-1];this.get("rendered")?(c.pluginCreateDom&&c.pluginCreateDom(this),c.pluginRenderUI&&c.pluginRenderUI(this),c.pluginBindUI&&c.pluginBindUI(this),c.pluginSyncUI&&c.pluginSyncUI(this)):this.get("created")&&c.pluginCreateDom&&c.pluginCreateDom(this);return this}},{__hooks__:{createDom:h("__createDom"),
renderUI:h("__renderUI"),bindUI:h("__bindUI"),syncUI:h("__syncUI")},name:"ComponentProcess",ATTRS:{rendered:{value:!1,setter:function(c){c&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return o},{requires:["base","promise"]});KISSY.add("component/control/render-tpl",'<div id="{{id}}"\n class="{{getBaseCssClasses ""}}\n{{#each elCls}}\n {{.}}  \n{{/each}}\n"\n\n{{#each elAttrs}} \n {{xkey}}="{{.}}"  \n{{/each}}\n\nstyle="\n{{#each elStyle}} \n {{xkey}}:{{.}};  \n{{/each}}\n">');
KISSY.add("component/control/render",function(c,k,h,q,e){function r(d){"number"==typeof d&&(d+="px");return d}function o(d){d||(d=[""]);"string"==typeof d&&(d=d.split(/\s+/));return d}function g(d,a,c){for(var b="",f=0,n=c.length,a=d+a;f<n;f++)d=(d=c[f])?"-"+d:d,b+=" "+a+d;return b}function l(d){var a;d.target==this.control&&(a=this[b+d.type.slice(5).slice(0,-6)],a.call(this,d.newVal,d))}function t(d,a){return this.getBaseCssClasses(a.params[0])}function a(d,a){return this.getBaseCssClass(a.params[0])}
var b="_onSet",u=c.trim,x=c.all,v=c.UA,p=c.Env.host.document,w;return w=k.extend({isRender:!0,createInternal:function(){var d=this.control.get("srcNode");d?this.decorateDom(d):w.superclass.createInternal.apply(this,arguments)},beforeCreateDom:function(d){var a=this.control,c,b,f,n=a.get("elAttrs"),e=a.get("elCls"),m;c=a.getAttrs();m=a.get("elStyle");var j=a.get("elCls");for(b in c)f=c[b],f.view&&(d[b]=a.get(b));c=d.width;b=d.height;f=d.visible;d=d.zIndex;c&&(m.width=r(c));b&&(m.height=r(b));d&&(m["z-index"]=
d);f||j.push(this.getBaseCssClasses("hidden"));if(m=a.get("disabled"))e.push(this.getBaseCssClasses("disabled")),n["aria-disabled"]="true";a.get("highlighted")&&e.push(this.getBaseCssClasses("hover"));a.get("focusable")&&(v.ie&&(n.hideFocus="true"),n.tabindex=m?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData={},this.childrenElSelectors={},this.renderCommands={getBaseCssClasses:c.bind(t,this),getBaseCssClass:c.bind(a,this)});var d=this.control,i;i=this.renderTpl(q+this.get("contentTpl")+
"</div>");d.setInternal("el",this.$el=x(i));this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){var i=this.constructor,b=this.control,e,f,n;a.attr("id")||a.attr("id",b.get("id"));n=this.__collectConstructorChains();for(e=n.length-1;0<=e;e--)if(i=n[e],f=i.HTML_PARSER){var i=a,g=b,m=void 0,j=void 0,j=void 0;for(m in f)j=f[m],"function"===typeof j?(j=j.call(this,i),void 0!==j&&g.setInternal(m,j)):"string"==typeof j?g.setInternal(m,i.one(j)):c.isArray(j)&&j[0]&&g.setInternal(m,
i.all(j[0]))}b.setInternal("el",this.$el=a);this.el=a[0]},renderUI:function(){var a=this.control,c=this.$el;if(!a.get("srcNode")){var b=a.get("render");(a=a.get("elBefore"))?c.insertBefore(a,void 0):b?c.appendTo(b,void 0):c.appendTo(p.body,void 0)}},bindUI:function(){var a=this.control,i=a.getAttrs(),s,e;for(s in i){e=i[s];var f=c.ucfirst(s),g=this[b+f];if(e.view&&g)a.on("after"+f+"Change",l,this)}},destructor:function(){this.$el&&this.$el.remove()},$:function(a){return this.$el.all(a)},fillChildrenElsBySelectors:function(a){var b=
this.$el,s=this.control,e,f,a=a||this.childrenElSelectors;for(e in a)f=a[e],"function"===typeof f?s.setInternal(e,f(b)):s.setInternal(e,this.$(c.substitute(f,this.renderData))),delete a[e]},renderTpl:function(a,c,b){c=c||this.renderData;b=b||this.renderCommands;return(new h(a,{commands:b})).render(c)},getComponentConstructorByNode:function(a,c){var b=c[0].className;return b?(b=b.replace(RegExp("\\b"+a,"ig"),""),e.getConstructorByXClass(b)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;
for(var a=this.control.constructor,b,c=[];a&&!a.prototype.hasOwnProperty("isControl");)(b=a.xclass)&&c.push(b),a=a.superclass&&a.superclass.constructor;return this.componentCssClasses=c},getBaseCssClasses:function(a){for(var a=o(a),b=this.getComponentCssClasses(),c=0,e=this.get("control"),f="",n=b.length,e=e.get("prefixCls");c<n;c++)f+=g(e,b[c],a);return u(f)},getBaseCssClass:function(a){return u(g(this.control.get("prefixCls"),this.getComponentCssClasses()[0],o(a)))},getKeyEventTarget:function(){return this.$el},
_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var b=this.$el;b.html(a);9>v.ie&&!this.get("allowTextSelection")&&b.unselectable()},_onSetVisible:function(a){var b=this.$el,c=this.getBaseCssClasses("hidden");a?b.removeClass(c):b.addClass(c)},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.control,c=this.getBaseCssClasses("disabled");this.$el[a?
"addClass":"removeClass"](c).attr("aria-disabled",a);b.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.$el,c=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](c)},_onSetZIndex:function(a){this.$el.css("z-index",a)}},{__hooks__:{decorateDom:k.prototype.__getHook__("__decorateDom"),beforeCreateDom:k.prototype.__getHook__("__beforeCreateDom")},
extend:function i(a,b,e){var g={},h=k.extend.apply(this,arguments);c.isArray(a)&&(c.each(a.concat(h),function(a){a&&c.each(a.HTML_PARSER,function(a,b){g[b]=a})}),h.HTML_PARSER=g);h.extend=i;return h},ATTRS:{control:{setter:function(a){this.control=a}},contentTpl:{value:"{{{content}}}"}},HTML_PARSER:{id:function(a){return(a=a[0].id)?a:void 0},content:function(a){return a.html()},disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})},{requires:["./process","xtemplate",
"./render-tpl","component/manager"]});
KISSY.add("component/control",function(c,k,h,q,e,r){function o(){var a,b=this;do a=b.ATTRS,b=b.superclass;while(!a||!a.xrender);return a.xrender.value}var g=c.Env.host.document.documentMode||c.UA.ie,l=k.Gesture,t=c.Features.isTouchEventSupported(),e=h.extend({isControl:!0,createDom:function(){var a=this.get("xrender"),b=this.get("view"),c=this.get("id");b?b.set("control",this):this.set("view",this.view=b=new a({control:this}));b.create();a=b.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable();
q.addComponent(c,this)},renderUI:function(){this.view.render()},bindUI:function(){var a=this.view.getKeyEventTarget();if(this.get("focusable"))a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleMouseEvents")){a=this.$el;if(!t)a.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,this);a.on(l.start,this.handleMouseDown,this).on(l.end,this.handleMouseUp,
this).on(l.tap,this.handleClick,this);if(l.cancel)a.on(l.cancel,this.handleMouseUp,this);if(g&&9>g)a.on("dblclick",this.handleDblClick,this)}},sync:function(){this.fire("beforeSyncUI");this.callMethodByHierarchy("syncUI","__syncUI");this.view.sync();this.callPluginsMethod("syncUI");this.fire("afterSyncUI")},createComponent:function(a,b){return q.createComponent(a,b||this)},_onSetFocused:function(a){var b=this.view.getKeyEventTarget()[0];a?b.focus():b.ownerDocument.activeElement==b&&b.ownerDocument.body.focus()},
_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},_onSetVisible:function(a){this.fire(a?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},move:function(a,b){this.set({x:a,y:b})},handleDblClick:function(a){this.get("disabled")||this.handleDblClickInternal(a)},
handleDblClickInternal:function(a){this.handleClickInternal(a)},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",!1);this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;
if(1==a.which||t)this.get("activeable")&&this.set("active",!0),this.get("focusable")&&this.focus(),this.get("allowTextSelection")||(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!=b&&"textarea"!=b&&a.preventDefault())},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&(1==a.which||t)&&this.set("active",!1)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},
handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){return!this.get("disabled")&&this.handleKeyDownInternal(a)?(a.halt(),!0):r},handleKeyDownInternal:function(a){return a.keyCode==k.KeyCode.ENTER?this.handleClickInternal(a):r},handleClick:function(a){this.get("disabled")||
this.handleClickInternal(a)},handleClickInternal:function(){},destructor:function(){q.removeComponent(this.get("id"));this.view&&this.view.destroy()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return c.guid("ks-component")}},content:{view:1,value:""},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(a){"string"==typeof a&&(a=a.split(/\s+/));return a||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(a){this.$el=a;this.el=a[0]}},
x:{},y:{},xy:{setter:function(a){var b=c.makeArray(a);b.length&&(b[0]&&this.set("x",b[0]),b[1]&&this.set("y",b[1]));return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(a){return k.all(a)}},handleMouseEvents:{value:!0},focusable:{value:!0,view:1},allowTextSelection:{value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:c.config("component/prefixCls")||
"ks-"},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:e},view:{setter:function(a){this.view=a}}}});e.getDefaultRender=o;e.extend=function b(e,g,k){var p=c.makeArray(arguments),l,d=p[p.length-1];if(l=d.xclass)d.name=l;p=h.extend.apply(this,p);l&&q.setConstructorByXClass(l,p);p.extend=b;p.getDefaultRender=o;return p};return e},{requires:["node","./control/process","component/manager","./control/render"]});
